{"ast":null,"code":"const Crypto = require(\"crypto-js\");\n\nexport default class Signature {\n  static getSignature(config, date, policyBase64) {\n    const getSignatureKey = (key, dateStamp, regionName) => {\n      const kDate = Crypto.HmacSHA256(dateStamp, \"AWS4\" + key);\n      const kRegion = Crypto.HmacSHA256(regionName, kDate);\n      const kService = Crypto.HmacSHA256(\"s3\", kRegion);\n      const kSigning = Crypto.HmacSHA256(\"aws4_request\", kService);\n      return kSigning;\n    };\n\n    const signature = policyEncoded => {\n      return Crypto.HmacSHA256(policyEncoded, getSignatureKey(config.secretAccessKey, date, config.region)).toString(Crypto.enc.Hex);\n    };\n\n    return signature(policyBase64);\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}